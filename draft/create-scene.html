<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixelar - Generate Scene</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Configuration from Design System -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            accent: '#FF715B',
                            accentHover: '#FF4F33',
                            surface: '#FFFFFF',
                            canvas: '#F4F4F0',
                            border: '#18181B',
                            text: '#18181B',
                            textMuted: '#71717A'
                        }
                    },
                    fontFamily: {
                        sans: ['Space Grotesk', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    boxShadow: {
                        'hard': '4px 4px 0px 0px #18181B',
                        'hard-sm': '2px 2px 0px 0px #18181B',
                        'hard-hover': '6px 6px 0px 0px #18181B',
                        'hard-active': '0px 0px 0px 0px #18181B',
                    },
                    borderWidth: {
                        '3': '3px',
                    },
                    backgroundImage: {
                        'sprite-grid': `linear-gradient(45deg, #f1f1f1 25%, transparent 25%),
                                        linear-gradient(-45deg, #f1f1f1 25%, transparent 25%),
                                        linear-gradient(45deg, transparent 75%, #f1f1f1 75%),
                                        linear-gradient(-45deg, transparent 75%, #f1f1f1 75%)`
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F4F4F0;
            background-image: radial-gradient(#D4D4D8 2px, transparent 2px);
            background-size: 24px 24px;
        }

        .btn-press {
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-press:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px 0px #18181B;
        }

        /* Loading Scanline */
        @keyframes scan {
            0% {
                transform: translateY(-100%);
            }

            100% {
                transform: translateY(100%);
            }
        }

        .scanline {
            animation: scan 2s linear infinite;
            background: linear-gradient(to bottom, transparent, rgba(255, 113, 91, 0.2), transparent);
        }

        /* Custom Radio Button Styling */
        input[type="radio"]:checked+div {
            background-color: #18181B;
            color: #FFFFFF;
        }

        input[type="radio"]:checked+div .check-icon {
            opacity: 1;
        }

        /* Custom number input styling */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>

<body class="text-brand-text font-sans antialiased min-h-screen flex flex-col relative">

    <!-- Navbar -->
    <header class="bg-white border-b-3 border-brand-border sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-6">
                <a href="projects.html"
                    class="flex items-center gap-2 font-mono text-xs font-bold hover:text-brand-accent transition-colors">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i>
                    DASHBOARD
                </a>
                <div class="h-6 w-0.5 bg-brand-border/20"></div>
                <h1 class="text-xl font-bold tracking-tight text-brand-text">Scene Generator</h1>
            </div>

            <!-- Credits -->
            <div
                class="flex items-center gap-2 font-mono text-xs font-bold text-brand-text bg-white px-3 py-1 border-2 border-brand-border shadow-hard-sm">
                <i data-lucide="zap" class="w-3 h-3 text-brand-accent"></i>
                CREDITS: <span id="creditCount">450</span>
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-7xl mx-auto w-full p-6 md:p-10 grid lg:grid-cols-12 gap-8">

        <!-- LEFT COLUMN: CONTROLS -->
        <section class="lg:col-span-5 space-y-8">

            <!-- Prompt Input -->
            <div class="space-y-3">
                <div class="flex justify-between items-end">
                    <label class="font-mono text-xs font-bold uppercase text-brand-text flex items-center gap-2">
                        <i data-lucide="terminal" class="w-4 h-4"></i>
                        /// INPUT_TERMINAL
                    </label>
                    <span
                        class="text-[10px] font-mono text-brand-accent bg-brand-accent/10 px-2 py-0.5 rounded">DIRECT_COMMAND_MODE</span>
                </div>

                <div class="relative">
                    <textarea id="promptInput" rows="5"
                        class="w-full bg-white border-3 border-brand-border p-4 font-mono text-sm outline-none focus:border-brand-accent focus:shadow-hard transition-all resize-none placeholder:text-gray-300"
                        placeholder="A dark cyberpunk street alley at night with neon signs reflecting in rain puddles, high contrast, pixel art style..."></textarea>
                </div>
            </div>

            <!-- Parameters Matrix -->
            <div class="grid grid-cols-2 gap-6">

                <!-- Dimensions -->
                <div class="col-span-2 space-y-3">
                    <label class="font-mono text-xs font-bold uppercase text-brand-textMuted">/// DIMENSIONS</label>
                    <div class="grid grid-cols-4 gap-2">
                        <!-- Option 1 -->
                        <label class="cursor-pointer group relative">
                            <input type="radio" name="dimensions" value="square" class="peer sr-only"
                                onchange="toggleCustomDims()" checked>
                            <div
                                class="border-2 border-brand-border bg-white p-2 flex flex-col items-center justify-center gap-1 hover:bg-brand-canvas transition-colors h-16">
                                <div class="w-4 h-4 border-2 border-current rounded-sm"></div>
                                <span class="font-mono text-[10px] font-bold">1:1</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>
                        <!-- Option 2 -->
                        <label class="cursor-pointer group relative">
                            <input type="radio" name="dimensions" value="landscape" class="peer sr-only"
                                onchange="toggleCustomDims()">
                            <div
                                class="border-2 border-brand-border bg-white p-2 flex flex-col items-center justify-center gap-1 hover:bg-brand-canvas transition-colors h-16">
                                <div class="w-6 h-3 border-2 border-current rounded-sm"></div>
                                <span class="font-mono text-[10px] font-bold">2:1</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>
                        <!-- Option 3 -->
                        <label class="cursor-pointer group relative">
                            <input type="radio" name="dimensions" value="portrait" class="peer sr-only"
                                onchange="toggleCustomDims()">
                            <div
                                class="border-2 border-brand-border bg-white p-2 flex flex-col items-center justify-center gap-1 hover:bg-brand-canvas transition-colors h-16">
                                <div class="w-3 h-6 border-2 border-current rounded-sm"></div>
                                <span class="font-mono text-[10px] font-bold">1:2</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>
                        <!-- Option 4: Custom -->
                        <label class="cursor-pointer group relative">
                            <input type="radio" name="dimensions" value="custom" class="peer sr-only"
                                onchange="toggleCustomDims()">
                            <div
                                class="border-2 border-brand-border bg-white p-2 flex flex-col items-center justify-center gap-1 hover:bg-brand-canvas transition-colors h-16">
                                <i data-lucide="sliders-horizontal" class="w-4 h-4"></i>
                                <span class="font-mono text-[10px] font-bold">CUSTOM</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>
                    </div>

                    <!-- Custom Inputs (Hidden by default) -->
                    <div id="customDimsContainer" class="hidden grid-cols-2 gap-4 pt-2 animate-[fadeIn_0.2s_ease-out]">
                        <div class="relative">
                            <span
                                class="absolute left-3 top-2.5 font-mono text-xs text-brand-textMuted font-bold">W:</span>
                            <input type="number" value="1920"
                                class="w-full bg-white border-2 border-brand-border py-2 pl-8 pr-2 font-mono text-sm outline-none focus:shadow-hard-sm">
                        </div>
                        <div class="relative">
                            <span
                                class="absolute left-3 top-2.5 font-mono text-xs text-brand-textMuted font-bold">H:</span>
                            <input type="number" value="1080"
                                class="w-full bg-white border-2 border-brand-border py-2 pl-8 pr-2 font-mono text-sm outline-none focus:shadow-hard-sm">
                        </div>
                    </div>
                </div>

                <!-- Style -->
                <div class="col-span-2 space-y-3">
                    <div class="flex justify-between items-center">
                        <label class="font-mono text-xs font-bold uppercase text-brand-textMuted">///
                            RENDER_STYLE</label>
                        <span
                            class="text-[10px] font-mono text-brand-textMuted bg-gray-100 px-1 border border-gray-200">OPTIONAL</span>
                    </div>

                    <div class="grid grid-cols-3 gap-2">
                        <!-- Auto/None Option -->
                        <label class="cursor-pointer group relative">
                            <input type="radio" name="style" value="auto" class="peer sr-only" checked>
                            <div
                                class="border-2 border-brand-border bg-white px-2 py-3 flex flex-col items-center justify-center hover:bg-brand-canvas transition-colors h-20 text-center">
                                <i data-lucide="sparkles"
                                    class="w-4 h-4 mb-2 text-brand-textMuted group-hover:text-brand-accent"></i>
                                <span class="font-mono text-[10px] font-bold">AUTO / ANY</span>
                            </div>
                        </label>

                        <label class="cursor-pointer group relative">
                            <input type="radio" name="style" value="pixel" class="peer sr-only">
                            <div
                                class="border-2 border-brand-border bg-white px-2 py-3 flex flex-col items-center justify-center hover:bg-brand-canvas transition-colors h-20 text-center">
                                <i data-lucide="grid" class="w-4 h-4 mb-2"></i>
                                <span class="font-mono text-[10px] font-bold">PIXEL_ART</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>

                        <label class="cursor-pointer group relative">
                            <input type="radio" name="style" value="flat" class="peer sr-only">
                            <div
                                class="border-2 border-brand-border bg-white px-2 py-3 flex flex-col items-center justify-center hover:bg-brand-canvas transition-colors h-20 text-center">
                                <i data-lucide="layers" class="w-4 h-4 mb-2"></i>
                                <span class="font-mono text-[10px] font-bold">FLAT_2D</span>
                                <i data-lucide="check"
                                    class="check-icon w-3 h-3 absolute top-1 right-1 opacity-0 transition-opacity text-brand-accent"></i>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Reference Image -->
                <div class="col-span-2 space-y-3">
                    <div class="flex justify-between items-center">
                        <label class="font-mono text-xs font-bold uppercase text-brand-textMuted">///
                            REFERENCE_SIGNAL</label>
                        <span
                            class="text-[10px] font-mono text-brand-textMuted bg-gray-100 px-1 border border-gray-200">OPTIONAL</span>
                    </div>
                    <div
                        class="border-2 border-dashed border-brand-textMuted/50 bg-brand-canvas/50 rounded-none p-4 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-brand-canvas hover:border-brand-text transition-all group">
                        <div
                            class="w-10 h-10 bg-white border-2 border-brand-border flex items-center justify-center mb-2 shadow-hard-sm group-hover:-translate-y-1 transition-transform">
                            <i data-lucide="upload-cloud" class="w-5 h-5 text-brand-text"></i>
                        </div>
                        <p class="font-mono text-[10px] font-bold text-brand-textMuted">DRAG_DROP OR CLICK TO UPLOAD</p>
                    </div>
                </div>

            </div>

            <!-- Generate Button -->
            <div class="pt-4 border-t-2 border-brand-border">
                <button onclick="generateScene()" id="generateBtn"
                    class="btn-press w-full bg-brand-accent text-white border-3 border-brand-border shadow-hard hover:bg-brand-accentHover py-4 flex items-center justify-center gap-3 group relative overflow-hidden">
                    <span class="font-mono font-bold text-sm tracking-widest uppercase z-10">Initialize
                        Generation</span>
                    <span class="font-mono text-[10px] font-bold bg-black/20 px-2 py-0.5 rounded text-white z-10">-1
                        CREDIT</span>
                    <i data-lucide="cpu" class="w-5 h-5 z-10 group-hover:rotate-90 transition-transform"></i>
                </button>
            </div>

        </section>

        <!-- RIGHT COLUMN: RESULTS VISUALIZATION -->
        <section class="lg:col-span-7 flex flex-col h-full min-h-[600px] relative">

            <!-- Main Viewport Container -->
            <div id="resultsContainer"
                class="flex-1 bg-white border-3 border-brand-border shadow-hard relative flex flex-col">

                <!-- Viewport Content Area -->
                <div class="flex-1 relative overflow-hidden bg-brand-canvas">

                    <!-- Initial State -->
                    <div id="emptyState"
                        class="absolute inset-0 flex flex-col items-center justify-center text-center p-6 bg-sprite-grid sprite-bg opacity-50">
                        <div class="inline-block p-4 border-2 border-brand-border bg-white mb-4 shadow-hard-sm">
                            <i data-lucide="monitor" class="w-8 h-8 text-brand-textMuted"></i>
                        </div>
                        <h3 class="font-mono font-bold text-brand-text text-sm uppercase">Viewport Ready</h3>
                        <p class="font-mono text-xs text-brand-textMuted mt-1 max-w-xs mx-auto">
                            Waiting for input signal to render preview...
                        </p>
                    </div>

                    <!-- Loading State (Hidden) -->
                    <div id="loadingState"
                        class="hidden absolute inset-0 bg-brand-text z-20 flex flex-col items-center justify-center text-brand-accent">
                        <div class="font-mono text-4xl font-bold tracking-widest mb-4">PROCESSING</div>
                        <div class="w-64 h-2 border border-brand-accent p-0.5">
                            <div class="h-full bg-brand-accent w-0 animate-[width_3s_ease-in-out_infinite]"
                                style="animation-name: progressLoading;"></div>
                        </div>
                        <style>
                            @keyframes progressLoading {
                                0% {
                                    width: 0%;
                                }

                                50% {
                                    width: 100%;
                                }

                                100% {
                                    width: 0%;
                                }
                            }
                        </style>
                        <div class="font-mono text-xs mt-4 text-white">/// SYNTHESIZING_PIXELS...</div>
                        <div class="absolute inset-0 scanline pointer-events-none opacity-20"></div>
                    </div>

                    <!-- Results Grid (Hidden) -->
                    <div id="resultsGrid"
                        class="hidden w-full h-full p-6 overflow-y-auto grid-cols-1 md:grid-cols-2 gap-6 content-start">
                        <!-- Cards injected by JS -->
                    </div>
                </div>

                <!-- Status Bar Footer -->
                <div
                    class="h-8 bg-brand-text text-white flex items-center justify-between px-3 font-mono text-[10px] uppercase border-t-2 border-brand-border z-10">
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-brand-textMuted" id="statusLight"></span>
                        <span id="statusText">SYSTEM_IDLE</span>
                    </div>
                    <div>
                        OUT_MODE: RGB_COLOR
                    </div>
                </div>

            </div>
        </section>

    </main>

    <!-- Image Inspection Modal (New) -->
    <div id="inspectModal" class="fixed inset-0 z-[100] bg-brand-text/90 hidden items-center justify-center p-4">
        <div class="relative max-w-5xl w-full max-h-[90vh] bg-brand-border p-2 shadow-hard border-2 border-white">
            <button onclick="closeInspect()"
                class="absolute -top-4 -right-4 bg-brand-accent text-white p-2 border-2 border-brand-border shadow-hard hover:bg-brand-accentHover z-50">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <img id="inspectImage" src="" class="w-full h-full object-contain bg-sprite-grid">
            <div
                class="absolute bottom-4 left-4 bg-black/80 text-white px-4 py-2 font-mono text-xs font-bold border border-white/20">
                INSPECTION_MODE
            </div>
        </div>
    </div>

    <!-- JS Logic -->
    <script>
        let credits = 450;
        const generateBtn = document.getElementById('generateBtn');
        const emptyState = document.getElementById('emptyState');
        const loadingState = document.getElementById('loadingState');
        const resultsGrid = document.getElementById('resultsGrid');
        const statusText = document.getElementById('statusText');
        const statusLight = document.getElementById('statusLight');
        const creditCount = document.getElementById('creditCount');
        const customDimsContainer = document.getElementById('customDimsContainer');

        function toggleCustomDims() {
            const isCustom = document.querySelector('input[name="dimensions"][value="custom"]').checked;
            if (isCustom) {
                customDimsContainer.classList.remove('hidden');
                customDimsContainer.classList.add('grid');
            } else {
                customDimsContainer.classList.add('hidden');
                customDimsContainer.classList.remove('grid');
            }
        }

        function generateScene() {
            const prompt = document.getElementById('promptInput').value;

            if (!prompt.trim()) {
                alert("ERROR: INPUT_TERMINAL_EMPTY. Please define parameters.");
                return;
            }

            // Start Loading
            emptyState.classList.add('hidden');
            resultsGrid.classList.add('hidden');
            loadingState.classList.remove('hidden');

            statusText.innerText = "RENDERING...";
            statusLight.classList.remove('bg-brand-textMuted');
            statusLight.classList.add('bg-brand-accent', 'animate-pulse');

            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-50', 'cursor-not-allowed');

            // Simulate API Call
            setTimeout(() => {
                loadingState.classList.add('hidden');
                resultsGrid.classList.remove('hidden');

                statusText.innerText = "RENDER_COMPLETE";
                statusLight.classList.remove('bg-brand-accent', 'animate-pulse');
                statusLight.classList.add('bg-green-500');

                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-50', 'cursor-not-allowed');

                // Deduct Credit
                credits--;
                creditCount.innerText = credits;

                renderResults();
            }, 3000);
        }

        function renderResults() {
            const dim = document.querySelector('input[name="dimensions"]:checked').value;

            // Determine Aspect Ratio class
            let aspectRatioClass = 'aspect-square';
            if (dim === 'landscape') aspectRatioClass = 'aspect-[2/1]';
            if (dim === 'portrait') aspectRatioClass = 'aspect-[1/2]';
            if (dim === 'custom') aspectRatioClass = 'aspect-video'; // Default fallback for custom

            // Mock Images
            const results = [1, 2, 3, 4]; // Added one more result for better grid balance

            const grid = document.getElementById('resultsGrid');
            grid.classList.add('grid'); // Ensure grid class is applied

            grid.innerHTML = results.map(i => {
                const imgUrl = `https://picsum.photos/seed/${Math.random()}/1000/600`;
                return `
                <div class="group relative bg-white border-2 border-brand-border shadow-hard hover:shadow-hard-hover transition-all duration-300 flex flex-col">
                    
                    <!-- Preview Container -->
                    <div class="w-full ${aspectRatioClass} bg-brand-canvas border-b-2 border-brand-border relative overflow-hidden cursor-zoom-in group/image" onclick="inspectImage('${imgUrl}')">
                        <img src="${imgUrl}" class="w-full h-full object-cover">
                        
                        <!-- Hover Overlay for Zoom Hint -->
                        <div class="absolute inset-0 bg-black/10 opacity-0 group-hover/image:opacity-100 transition-opacity flex items-center justify-center pointer-events-none">
                            <span class="bg-white border-2 border-brand-border px-2 py-1 font-mono text-[10px] font-bold shadow-sm">
                                <i data-lucide="zoom-in" class="w-3 h-3 inline mr-1"></i> INSPECT
                            </span>
                        </div>
                        
                        <!-- Variation Tag -->
                        <div class="absolute top-2 left-2 bg-brand-text text-white px-2 py-0.5 font-mono text-[10px] font-bold shadow-sm">
                            VAR_0${i}
                        </div>
                    </div>
                    
                    <!-- Actions Footer -->
                    <div class="p-3 bg-white flex gap-2 items-center">
                        <button onclick="selectResult(${i})" class="btn-press flex-1 py-2 bg-brand-text text-white font-mono text-xs font-bold uppercase hover:bg-brand-accent transition-colors flex items-center justify-center gap-2 border-2 border-transparent">
                            <span>Select</span>
                            <i data-lucide="arrow-right" class="w-3 h-3"></i>
                        </button>
                         <button class="p-2 bg-white border-2 border-brand-border hover:bg-brand-canvas transition-colors text-brand-textMuted hover:text-brand-text" title="Download">
                            <i data-lucide="download" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `}).join('');

            lucide.createIcons();
        }

        function inspectImage(url) {
            const modal = document.getElementById('inspectModal');
            const img = document.getElementById('inspectImage');
            img.src = url;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeInspect() {
            const modal = document.getElementById('inspectModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function selectResult(id) {
            if (confirm(`CONFIRM SELECTION: Initialize Project with Variation 0${id}?`)) {
                window.location.href = 'projects.html';
            }
        }

        // Initialize Icons
        lucide.createIcons();
    </script>
</body>

</html>